awk 'NR==FNR{a[$2]=$1;next} {gsub(/\.txt$/, "", $2); for (i in a) {if (match($0, " " a[i] " ") || match($0, "^" a[i] " ") || match($0, " " a[i] "$")) {print $0, a[i]; next}} print $0, 0}' b.txt a.txt > merge.txt
